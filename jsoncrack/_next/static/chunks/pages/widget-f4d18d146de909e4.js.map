{"version":3,"file":"static/chunks/pages/widget-f4d18d146de909e4.js","mappings":"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","sources":["webpack://_N_E/?7626","webpack://_N_E/./src/pages/widget.tsx"],"sourcesContent":["\n    (window.__NEXT_P = window.__NEXT_P || []).push([\n      \"/widget\",\n      function () {\n        return require(\"private-next-pages/widget.tsx\");\n      }\n    ]);\n    if(module.hot) {\n      module.hot.dispose(function () {\n        window.__NEXT_P.push([\"/widget\"])\n      });\n    }\n  ","import React from \"react\";\r\nimport dynamic from \"next/dynamic\";\r\nimport { useRouter } from \"next/router\";\r\nimport { useMantineColorScheme } from \"@mantine/core\";\r\nimport { ThemeProvider } from \"styled-components\";\r\nimport { NextSeo } from \"next-seo\";\r\nimport toast from \"react-hot-toast\";\r\nimport { darkTheme, lightTheme } from \"../constants/theme\";\r\nimport { Toolbar } from \"../features/editor/Toolbar\";\r\nimport useGraph from \"../features/editor/views/GraphView/stores/useGraph\";\r\nimport useFile from \"../store/useFile\";\r\nimport type { LayoutDirection } from \"../types/graph\";\r\n\r\ninterface EmbedMessage {\r\n  data: {\r\n    json?: string;\r\n    options?: {\r\n      theme?: \"light\" | \"dark\";\r\n      direction?: LayoutDirection;\r\n    };\r\n  };\r\n}\r\n\r\nconst GraphView = dynamic(\r\n  () => import(\"../features/editor/views/GraphView\").then(c => c.GraphView),\r\n  {\r\n    ssr: false,\r\n  }\r\n);\r\n\r\nconst WidgetPage = () => {\r\n  const { query, push, isReady } = useRouter();\r\n  const { setColorScheme } = useMantineColorScheme();\r\n  const [theme, setTheme] = React.useState<\"dark\" | \"light\">(\"dark\");\r\n  const checkEditorSession = useFile(state => state.checkEditorSession);\r\n  const setContents = useFile(state => state.setContents);\r\n  const setDirection = useGraph(state => state.setDirection);\r\n  const clearGraph = useGraph(state => state.clearGraph);\r\n\r\n  React.useEffect(() => {\r\n    if (isReady) {\r\n      if (typeof query?.json === \"string\") checkEditorSession(query.json, true);\r\n      else clearGraph();\r\n\r\n      window.parent.postMessage(window.frameElement?.getAttribute(\"id\"), \"*\");\r\n    }\r\n  }, [clearGraph, checkEditorSession, isReady, push, query.json, query.partner]);\r\n\r\n  React.useEffect(() => {\r\n    const handler = (event: EmbedMessage) => {\r\n      try {\r\n        if (!event.data?.json) return;\r\n        if (event.data?.options?.theme === \"light\" || event.data?.options?.theme === \"dark\") {\r\n          setTheme(event.data.options.theme);\r\n        }\r\n\r\n        setContents({ contents: event.data.json, hasChanges: false });\r\n        setDirection(event.data.options?.direction || \"RIGHT\");\r\n      } catch (error) {\r\n        console.error(error);\r\n        toast.error(\"Invalid JSON!\");\r\n      }\r\n    };\r\n\r\n    window.addEventListener(\"message\", handler);\r\n    return () => window.removeEventListener(\"message\", handler);\r\n  }, [setColorScheme, setContents, setDirection, theme]);\r\n\r\n  React.useEffect(() => {\r\n    setColorScheme(theme);\r\n  }, [setColorScheme, theme]);\r\n\r\n  return (\r\n    <>\r\n      <NextSeo noindex />\r\n      <ThemeProvider theme={theme === \"dark\" ? darkTheme : lightTheme}>\r\n        <Toolbar isWidget />\r\n        <GraphView isWidget />\r\n      </ThemeProvider>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default WidgetPage;\r\n"],"names":["window","__NEXT_P","push","__webpack_require__","GraphView","dynamic","Promise","all","e","then","bind","c","ssr","__webpack_exports__","query","isReady","useRouter","setColorScheme","useMantineColorScheme","theme","setTheme","React","checkEditorSession","useFile","state","setContents","setDirection","useGraph","clearGraph","json","parent","postMessage","frameElement","getAttribute","partner","handler","event","data","options","contents","hasChanges","direction","error","console","toast","addEventListener","removeEventListener","react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__","jsxs","Fragment","jsx","NextSeo","noindex","ThemeProvider","darkTheme","lightTheme","Toolbar","isWidget"],"sourceRoot":""}